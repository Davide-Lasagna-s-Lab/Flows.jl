<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coupled systems · Flows.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Flows.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../quickstart/">Quick Start</a></li><li><a class="toctext" href="../monitors/">Monitors</a></li><li class="current"><a class="toctext" href>Coupled systems</a><ul class="internal"><li><a class="toctext" href="#Motivation-1">Motivation</a></li><li><a class="toctext" href="#Approach-1">Approach</a></li><li><a class="toctext" href="#Example-1">Example</a></li></ul></li><li><a class="toctext" href="../quadrature/">Quadrature equations</a></li><li><a class="toctext" href="../storage/">Solution storages</a></li><li><a class="toctext" href="../advanced/">Advanced features</a></li><li><a class="toctext" href="../examples/">Examples</a></li><li><a class="toctext" href="../available-methods/">Available methods</a></li><li><a class="toctext" href="../api/">Full API</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Coupled systems</a></li></ul><a class="edit-page" href="https://github.com/gasagna/Flows.jl/blob/master/docs/src/coupled.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Coupled systems</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Coupled-dynamical-systems-1" href="#Coupled-dynamical-systems-1">Coupled dynamical systems</a></h1><h2><a class="nav-anchor" id="Motivation-1" href="#Motivation-1">Motivation</a></h2><p>In some situations, the state is defined by two or more heterogeneous components, each obeying its own dynamics, but with some components that depend on each other. For instance, consider a problem where the state <span>$\mathbf{z}$</span> is defined by two components, say <span>$\mathbf{x}\in\mathcal{X}$</span> and <span>$\mathbf{y}\in\mathcal{Y}$</span>, as</p><div>\[\mathbf{z} = [\mathbf{x}, \mathbf{y}]\]</div><p>where now <span>$\mathbf{z} \in \mathcal{Z} \equiv \mathcal{X}\times \mathcal{Y}$</span>. Assume the dynamics of <span>$\mathbf{x}(t)$</span> to be independent from that of <span>$\mathbf{y}(t)$</span>, but that the latter somehow depends on the former. This situation would correspond to the problem</p><div>\[\left\{
\begin{array}{cc}
  \dot{\mathbf{x}}(t) =&amp; \mathbf{f}(t, \mathbf{x}(t))\\
  \dot{\mathbf{y}}(t) =&amp; \mathbf{g}(t, \mathbf{x}(t), \mathbf{y}(t))
\end{array}
\right.\]</div><p>A possible strategy to solve this problem is to first solve the first differential equation, store its solution, and the use it to solve the second, perhaps using some kind of interpolation if required. Storing a full solution is often not possible or desirable and the two systems must be solved in a coupled manner.</p><div class="admonition example"><div class="admonition-title">Example</div><div class="admonition-text"><p>A notable example is the solution of the linearised variational equations, governing the evolution of small perturbations to the initial conditions of an initial value problem. If <span>$\mathbf{x}(t)$</span> denotes the system&#39;s state governed by a nonlinear differential equation and <span>$\mathbf{y}(t)$</span> denotes the perturbation, the two components obey the coupled problem</p><div>\[\left\{
\begin{array}{c}
  \dot{\mathbf{x}}(t) =&amp; \mathbf{f}(t, \mathbf{x}(t))\\
  \dot{\mathbf{y}}(t) =&amp; \mathbf{f}_\mathbf{x}(t, \mathbf{x}(t))\cdot\mathbf{y}(t)
\end{array}
\right.\]</div><p>where <span>$\mathbf{f}_\mathbf{x}$</span> is the jacobian of <span>$\mathbf{f}$</span>.</p></div></div><h2><a class="nav-anchor" id="Approach-1" href="#Approach-1">Approach</a></h2><p>The fundamental tool provided by this package to address this need is the <code>couple</code> function, accepting two or more arguments and returning a <code>Coupled</code> object. This is a compact representation akin to a Julia <code>Tuple</code> object (internally, it is a shallow wrapper to a tuple) and thus behaves similar to it. For instance</p><pre><code class="language-julia">julia&gt; z = couple(Int[1, 2, 3], Float64[0, 4])
2-element Coupled{2,Tuple{Array{Int64,1},Array{Float64,1}}}:
 [1, 2, 3]
 [0.0, 4.0]

julia&gt; z[1] # it is indexable
Int[1, 2, 3]

julia&gt; length(z) # it has a length
2</code></pre><p>One feature of <code>Coupled</code> objects is that they support Julia&#39;s dot notation and operations are forwarded down to each of the internal components. For instance, code such as </p><pre><code class="language-julia">julia&gt; z1 = couple(Int[1, 2, 3], Float64[0, 4]);
julia&gt; z2 = couple(Int[2, 4, 5], Float64[1, 2]);
julia&gt; z1 .= z2 .* 2
2-element Coupled{2,Tuple{Array{Int64,1},Array{Float64,1}}}:
 [4, 8, 10]
 [2.0, 4.0]</code></pre><p>works as expected, where arithmetic operations are forwarded to the two components. The utility of this behaviour is that the arithmetic operations arising in the computation of a time step, e.g. during internal stages of a Runge-Kutta method, are forwarded to all components.</p><h2><a class="nav-anchor" id="Example-1" href="#Example-1">Example</a></h2><p>Assume that we want to solve the problem </p><div>\[\left\{
\begin{array}{cc}
  \dot{\mathbf{x}}(t) =&amp; \mathbf{f}(t, \mathbf{x}(t))\\
  \dot{\mathbf{y}}(t) =&amp; \mathbf{g}(t, \mathbf{x}(t), \mathbf{y}(t))
\end{array}
\right.\]</div><p>where the two components <span>$\mathbf{x}(t) \in \mathbb{R}^3$</span> and <span>$\mathbf{y}(t) \in \mathbb{R}^2$</span> are represented by standard Julia <code>Vector</code>s, for simplicity. Assume that two Julia functions <code>f</code> and <code>g</code> have been defined, with signatures</p><pre><code class="language-julia">f(t, x, dxdt)
g(t, x, dxdt, y, dydt)</code></pre><p>Note the definition of the second function, and how it maps to the original problem.</p><p>Assume that an explicit fourth-order Runge-Kutta method, provided by this package&#39;s <code>RK4</code> is used to advance the system. Two steps are neeeded. First, we couple together the Julia functions representing the two components by defining</p><pre><code class="language-julia">h = couple(f, g)</code></pre><p>Second, we define a composite <code>RK4</code> method object with </p><pre><code class="language-julia">m = RK4(couple(zeros(3), zeros(2)))</code></pre><p>where we have passed an instance of the type representing the coupled state, obtained by coupling together two temporary <code>Vector</code>s of the right size.</p><p>The flow operator can then finally be constructed as</p><pre><code class="language-julia">F = flow(h, m, TimeStepConstant(0.1))</code></pre><p>where we have declared that we will march the equations forward with time step <code>Δt = 0.1</code>.</p><p>The flow operator <code>F</code> can now be called on a composite state object. For instance, we define some initial conditions and march the problem in time, with</p><pre><code class="language-julia">x0 = Float64[0, 1, 0]
y0 = Float64[2, 3]

F(couple(x0, y0), (0, 1))</code></pre><p>Because <code>F</code> modifies its first argument in place, the <code>Vector</code>s <code>x0</code> and <code>y0</code> are modified by the call to <code>F</code>.</p><footer><hr/><a class="previous" href="../monitors/"><span class="direction">Previous</span><span class="title">Monitors</span></a><a class="next" href="../quadrature/"><span class="direction">Next</span><span class="title">Quadrature equations</span></a></footer></article></body></html>
